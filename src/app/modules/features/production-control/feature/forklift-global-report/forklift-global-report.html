<div class="flex flex-col gap-6 h-full p-4 md:p-6 lg:p-8 animate-in fade-in duration-1000">
	<!-- Glass Dashboard Header -->
	<forklift-report-header
		[overallStatus]="overallStatus()"
		[searchTerm]="searchTerm()"
		[isLoading]="alertsResource.isLoading()"
		(onSearchChange)="searchTerm.set($event)"
		(onReload)="reload()"
		(onClearFilters)="clearFilters()"
	/>

	<main class="space-y-8">
		<!-- Dynamic Metrics Grid -->
		<forklift-report-stats [stats]="stats()" [currentFilter]="statusFilter()" (onFilterChange)="setStatusFilter($event)" />

		<!-- Main Workspace (Areas Board) -->
		<div class="grid grid-cols-12 gap-8 items-start">
			@if (alertsResource.isLoading()) {
				<div class="col-span-12 flex flex-col items-center justify-center py-40 gap-6 opacity-50">
					<div class="relative w-20 h-20">
						<div class="absolute inset-0 border-4 border-primary-500/10 rounded-full"></div>
						<div class="absolute inset-0 border-4 border-primary-500 border-t-transparent rounded-full animate-spin"></div>
					</div>
					<span class="text-xs font-black tracking-[0.4em] text-surface-400 uppercase animate-pulse">Mapped Logistics Framework</span>
				</div>
			} @else if (groupedData().length > 0) {
				@for (area of groupedData(); track area.name) {
					<forklift-area-card [area]="area" (onAlertClick)="openAlertDetail($event)" />
				}
			} @else {
				<div class="col-span-12 flex flex-col items-center justify-center py-40 glass-card animate-in zoom-in duration-700">
					<div
						class="w-24 h-24 bg-surface-100/50 dark:bg-surface-800/50 rounded-4xl flex items-center justify-center mb-6 text-surface-300 shadow-inner border border-surface-200/20"
					>
						<span class="material-symbols-outlined text-6xl">grid_view</span>
					</div>
					<h3 class="text-2xl font-black text-surface-700 dark:text-surface-200 tracking-tighter uppercase m-0">No active matrix found</h3>
					<p class="text-surface-400 text-xs mt-3 max-w-[280px] text-center leading-relaxed font-bold uppercase tracking-widest opacity-60">
						Reajuste los parámetros de búsqueda o recargue el monitor global.
					</p>
					<p-button
						(onClick)="clearFilters()"
						label="RESET COMMANDER"
						severity="primary"
						styleClass="mt-8 px-8 py-4 font-black text-xs tracking-[0.3em] rounded-2xl shadow-xl shadow-primary-500/20 active:scale-95"
					/>
				</div>
			}
		</div>
	</main>

	<!-- Detail Modal (Premium Overlay) -->
	<forklift-alert-detail-modal
		[(visible)]="isModalVisible"
		[alert]="selectedAlert()"
		(onReassign)="reassignOperator()"
		(onNotify)="notifyPriority()"
		(onBoost)="markEmergency()"
	/>
</div>

<p-toast position="bottom-center" />

<style>
	:host ::ng-deep .modern-alert-dialog .p-dialog-content {
		padding: 0;
		border-radius: 3rem;
		overflow: hidden;
		background: transparent;
	}
	:host ::ng-deep .modern-alert-dialog .p-dialog-mask {
		backdrop-filter: blur(12px) saturate(180%);
		background-color: rgba(0, 0, 0, 0.4);
	}
</style>
