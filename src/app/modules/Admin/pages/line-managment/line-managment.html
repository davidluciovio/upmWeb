<div class="p-4 h-full">
	@if (!lines$.isLoading()) {
		@if (lines$.hasValue()) {
			<table-crud
				[data]="lines$.value()"
				[columns]="columns"
				(create)="createLine()"
				(edit)="editLine($event)"
				(delete)="deleteLine($event)"
			></table-crud>
		}
	} @else {
		<div class="flex flex-col items-center justify-center h-[400px]">
			<p-progressSpinner ariaLabel="loading" />
			<span class="text-lg font-semibold mt-4">Cargando datos...</span>
		</div>
	}
</div>

<p-dialog
	[(visible)]="displayModal"
	[header]="isEditMode ? 'Editar Linea' : 'Agregar Nueva Linea'"
	[modal]="true"
	[breakpoints]="{ '960px': '75vw', '640px': '90vw' }"
	[style]="{ width: '450px' }"
	draggable="false"
	resizable="false"
>
	<div [formGroup]="form" class="flex flex-col gap-6 py-4">
		<div class="flex flex-col gap-2">
			<label for="lineDescription" class="font-medium text-surface-700 dark:text-surface-0/70">Nombre de la Linea</label>
			<input pInputText id="lineDescription" type="text" formControlName="lineDescription" placeholder="Ej. LÃ­nea 1" class="w-full" />
		</div>

		<div class="flex items-center gap-3">
			<p-toggleSwitch id="active" formControlName="active" />
			<label for="active" class="cursor-pointer font-medium text-surface-700 dark:text-surface-0/70">Activo</label>
		</div>
	</div>

	<ng-template pTemplate="footer">
		<div class="flex justify-end gap-2">
			<p-button label="Cancelar" icon="pi pi-times" [text]="true" severity="secondary" (click)="closeModal()" />
			<p-button label="Guardar" icon="pi pi-check" [disabled]="form.invalid" (click)="save()" />
		</div>
	</ng-template>
</p-dialog>
